<include file="Public/header"/>
		<!-- basic styles -->
		<link href="__PUBLIC__/Admin/assets/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="__PUBLIC__/Admin/assets/css/font-awesome.min.css" />
		<!--[if IE 7]>
		  <link rel="stylesheet" href="__PUBLIC__/Admin/assets/css/font-awesome-ie7.min.css" />
		<![endif]-->
		<!-- page specific plugin styles -->
		<!-- fonts -->
		<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/assets/css/google_font_css.css">
		<link rel="stylesheet" href="__PUBLIC__/Admin/layui-v1.0.4/layui/css/layui.css"  media="all">
		<!-- ace styles -->
		<link rel="stylesheet" href="__PUBLIC__/Admin/assets/css/ace.min.css" />
		<link rel="stylesheet" href="__PUBLIC__/Admin/assets/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="__PUBLIC__/Admin/assets/css/ace-skins.min.css" />

		<link rel="stylesheet" href="__PUBLIC__/Admin/layui-v1.0.4/layui/css/layui.css"  media="all">
		<!--[if lte IE 8]>
		  <link rel="stylesheet" href="__PUBLIC__/Admin/assets/css/ace-ie.min.css" />
		<![endif]-->
		<!-- inline styles related to this page -->
		<!-- ace settings handler -->
		<script src="__PUBLIC__/Admin/assets/js/ace-extra.min.js"></script>
		<script src="__PUBLIC__/Admin/assets/js/jquery.min.js"></script>
		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script src="__PUBLIC__/Admin/assets/js/html5shiv.js"></script>
		<script src="__PUBLIC__/Admin/assets/js/respond.min.js"></script>
		<![endif]-->
		<!-- layui.js   -->
		<script src="__PUBLIC__/Admin/layui-v1.0.4/layui/layui.js"></script>
		<script src="__PUBLIC__/layer/layer.js"></script>


		<style type="text/css">
			.tr_red .icon-eye-open{color:red!important;}
		</style>
	</head>



	<body>

		<div class="navbar navbar-default" id="navbar">

			<include file="Public/navbar"/>

		</div>



		<div class="main-container" id="main-container">

			<script type="text/javascript">

				try{ace.settings.check('main-container' , 'fixed')}catch(e){}

			</script>



			<div class="main-container-inner">

				<a class="menu-toggler" id="menu-toggler" href="#">

					<span class="menu-text"></span>

				</a>



				<div class="sidebar" id="sidebar">

					<include file="Public/left"/>

				</div>



				<div class="main-content">

					<div class="breadcrumbs" id="breadcrumbs">

						<script type="text/javascript">

							try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}

						</script>



						<ul class="breadcrumb">
							<include file="Public/_breadcrumb"/>
						</ul><!-- .breadcrumb -->



						<div class="nav-search" id="nav-search">

							<form class="form-search">

								<span class="input-icon">

									<input type="text" placeholder="Search ..." class="nav-search-input" id="nav-search-input" autocomplete="off" />

									<i class="icon-search nav-search-icon"></i>

								</span>

							</form>

						</div><!-- #nav-search -->

					</div>



					<div class="page-content">

						<div class="row">
							<div class="col-xs-12">
							    <div class="panel panel-default">
							      <div class="panel-heading">权限列表
			      						<select name="pid_color" class="pid_color">
			      		                    <option value="">请选择分类</option>
			      		                    <foreach name="select" item="v">
			      		                    	<option value="{$v.id}" <if condition="$_POST['pid_color'] eq $v['id']">selected</if>>{$v.title}</option>
			      		                    </foreach>
			      		                </select>
					      				<label class="btn btn-info btn-xs"><input type="checkbox" class="btn_feijiedian" value="1">非节点</label>
					      				<label class="btn btn-info btn-xs"><input type="checkbox" class="btn_mokuai" value="1">模块</label>
					      				<label class="btn btn-info btn-xs"><input type="checkbox" class="btn_mokuai_feijiedian" value="1">模块_非节点</label>
					      				
							      </div>
							      <div class="panel-body">

							      	<div class="alert alert-danger" role="alert">
							      	  眼睛为绿<a href="#" class="alert-link">说明：在用户配置权限的时候是默认已选上的,并且隐藏</a>
							      	</div>

					      	        <ul class="list-group">

					      	        	<foreach name="action_list" item="v">
					      	        		<li class="list-group-item" <if condition="$v['status'] eq 1">style="background:red;"</if>>
					      	        		  <span class="badge">{$v.desc_cc}</span>
					      	        		  {$v.action}
					      	        		</li>
					      	        	</foreach>
					      	          
					      	        </ul>



							        <table id="sample-table-1" class="table table-striped table-bordered table-hover">
										<thead>
											<tr>
												<th class="center">排序</th>
												<th>菜单名称</th>
												<th class="hidden-480">类型</th>
												<th>显示（左侧菜单栏）</th>
												<th class="hidden-480">状态</th>
												<th>操作</th>
											</tr>
										</thead>
										<tbody>
											{$html_tree}
										</tbody>
									</table>
							      </div>
							    </div>
							</div>	
						</div>

					</div><!-- /.page-content -->

				</div><!-- /.main-content -->


			</div><!-- /.main-container-inner -->



			<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">

				<i class="icon-double-angle-up icon-only bigger-110"></i>

			</a>

		</div><!-- /.main-container -->


		<!-- 底栏版本说明 -->
		<include file="Public/footer"/>
		<!-- basic scripts -->



		<!--[if !IE]> -->






		<!-- <![endif]-->



		<!--[if IE]>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

<![endif]-->



		<!--[if !IE]> -->



		<script type="text/javascript">

			window.jQuery || document.write("<script src='assets/js/jquery-2.0.3.min.js'>"+"<"+"/script>");

		</script>



		<!-- <![endif]-->



		<!--[if IE]>

<script type="text/javascript">

 window.jQuery || document.write("<script src='assets/js/jquery-1.10.2.min.js'>"+"<"+"/script>");

</script>

<![endif]-->



		<script type="text/javascript">

			if("ontouchend" in document) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");

		</script>

		<script src="__PUBLIC__/Admin/assets/js/bootstrap.min.js"></script>

		<script src="__PUBLIC__/Admin/assets/js/typeahead-bs2.min.js"></script>



		<!-- page specific plugin scripts -->



		<script src="__PUBLIC__/Admin/assets/js/jquery.dataTables.min.js"></script>

		<script src="__PUBLIC__/Admin/assets/js/jquery.dataTables.bootstrap.js"></script>



		<!-- ace scripts -->



		<script src="http://localhost/zhangtr/ace_admin/assets/js/jquery-ui.custom.min.js"></script>

		<script src="__PUBLIC__/Admin/assets/js/jquery.ui.touch-punch.min.js"></script>

		<script src="__PUBLIC__/Admin/assets/js/bootbox.min.js"></script>

		<script src="http://localhost/zhangtr/ace_admin/assets/js/jquery.easypiechart.min.js"></script>

		<script src="__PUBLIC__/Admin/assets/js/jquery.gritter.min.js"></script>

		<script src="__PUBLIC__/Admin/assets/js/spin.min.js"></script>





		<script src="__PUBLIC__/Admin/assets/js/ace-elements.min.js"></script>

		<script src="__PUBLIC__/Admin/assets/js/ace.min.js"></script>



		<!-- inline scripts related to this page -->



		<script type="text/javascript">

			jQuery(function($) {

				var oTable1 = $('#sample-table-2').dataTable( {

				"aoColumns": [

			      { "bSortable": false },

			      null, null,null, null, null,

				  { "bSortable": false }

				] } );

				

				

				$('table th input:checkbox').on('click' , function(){

					var that = this;

					$(this).closest('table').find('tr > td:first-child input:checkbox')

					.each(function(){

						this.checked = that.checked;

						$(this).closest('tr').toggleClass('selected');

					});

						

				});

			

			

				$('[data-rel="tooltip"]').tooltip({placement: tooltip_placement});

				function tooltip_placement(context, source) {

					var $source = $(source);

					var $parent = $source.closest('table')

					var off1 = $parent.offset();

					var w1 = $parent.width();

			

					var off2 = $source.offset();

					var w2 = $source.width();

			

					if( parseInt(off2.left) < parseInt(off1.left) + parseInt(w1 / 2) ) return 'right';

					return 'left';

				}

				//排序
				$('body').on('blur' ,'.sort_input', function(){
					var _id = $(this).attr('data-id');
					var _sort=$(this).val();
					
			      	$.ajax({  
			      	    async:false,
			      	    type:'post',  
			      	    url : "{:U('Admin/AuthRule/ajax_sort')}",
			      	    dataType : 'json',
			      	    data:{'id':_id,'sort':_sort},
			      	    success  : function(json) { 
			      	        if(json.code==0){
			      	            
			      	        }else{
			      	            layer.msg(json.msg);
			      	        }
			      	    },
			      	    error  : function(json) {  
			      	        layer.msg(json.msg);
			      	    }  
			      	});  
				});

				//是否全显示
				$('.btn_feijiedian').click(function(){
					
					if($('.btn_feijiedian').is(':checked')) {
						$('#sample-table-1 tbody tr').hide();
					    $('#sample-table-1 tbody tr[level="非节点"]').show();
					}else{
						$('#sample-table-1 tbody tr').show();
					}
			      	
				});

				//是否全显示
				$('.btn_mokuai').click(function(){
					
					if($('.btn_mokuai').is(':checked')) {
						$('#sample-table-1 tbody tr').hide();
					    $('#sample-table-1 tbody tr[level="模块"]').show();
					}else{
						$('#sample-table-1 tbody tr').show();
					}
			      	
				});

				//是否全显示
				$('.btn_mokuai_feijiedian').click(function(){
					
					if($('.btn_mokuai_feijiedian').is(':checked')) {
						$('#sample-table-1 tbody tr').hide();
					    $('#sample-table-1 tbody tr[level="模块"]').show();
					    $('#sample-table-1 tbody tr[level="非节点"]').show();
					}else{
						$('#sample-table-1 tbody tr').show();
					}
			      	
				});

				

				

			})

		</script>



		<input type="hidden" name="cur_c" id="cur_c" value="Node">

		<input type="hidden" name="cur_v" id="cur_v" value="index">

		<script type="text/javascript">

		  $(function(){

		    var cur_c=$('#cur_c').val();

		    var cur_v=$('#cur_v').val();



		    $('.'+cur_c).addClass('active').addClass('open');

		    $('.'+cur_c+'_'+cur_v).addClass('active');

		  });



		  



		</script>



		<script type="text/javascript">
			$(function() {
			  	$(".del").on(ace.click_event, function() {
			  		var obj_tr=$(this).parents('tr');
			  		var id=$(this).attr('data-id');
					// bootbox.confirm("Are you sure?", function(result) {
						// if(result) {
							_ajax_del(obj_tr, id);
						// }
					// });
				});

			  	//设置在权限设置列表是否显示
				$("tr").dblclick(function() {
			  		var id=$(this).attr('id');
			  		var level=$(this).attr('level');
			  		var is_show=$(this).attr('is_show');
			  		var obj_tr=$(this);
			  		if(level=='方法'){
			  			_ajax_set_is_show(obj_tr, id, is_show);
			  		}
					
				});
			});


			//异步删除
			function _ajax_del(obj_tr, id){
			    $.ajax({  
			        type:'get',  
			        url : "{:U('Admin/AuthRule/ajax_del')}",
			        data:{ 
			          id:id 
			        },
			        dataType : 'json',
			        success  : function(json) {  
			            if(json.code == 0){
			                obj_tr.remove();
			            }else{
			                alert(json.msg);
			            }
			        },
			        error  : function() {  
			            alert('error');
			        }  
			    }); 
			}

			//异步设置在权限设置列表是否显示
			function _ajax_set_is_show(obj_tr, id, is_show){
			    $.ajax({  
			        type:'get',  
			        url : "{:U('Admin/AuthRule/ajax_set_is_show')}",
			        data:{ 
			          id:id,
			          is_show:is_show 
			        },
			        dataType : 'json',
			        success  : function(json) {  
			            if(json.code == 0){
			            	if(is_show==1){
			            		is_show=0;
			            		obj_tr.attr('is_show', is_show).removeClass('tr_red');
			            	}else{
			            		is_show=1;
			            		obj_tr.attr('is_show', is_show).addClass('tr_red');
			            	}
			                
			            }else{
			                alert(json.msg);
			            }
			        },
			        error  : function() {  
			            alert('error');
			        }  
			    }); 
			}

		</script>

<form id="pid_color_form" method="post" action="">
	<input type="text" name="pid_color" style="display:none;" class="input_pid_color" value="">
</form>		
<script>
$(function(){
		$(".pid_color").change(function(){
			$('form#pid_color_form input.input_pid_color').val($(this).val());
			$('form#pid_color_form').submit();
		});
});
</script>
	</body>

</html>

